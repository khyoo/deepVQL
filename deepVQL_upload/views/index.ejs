<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />

    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
  </head>
  <body>
    <div id="div_load_image" class="loadingArea">
      <img src="/images/loading1.gif" style="width:400px; height:400px;">
    </div>
    
    <input type="file" id="fileInput">
    <button type="submit" id="sendButton">전송</button>
 
    <script>
        const fileInput = document.querySelector("#fileInput");
        const sendButton = document.querySelector("#sendButton");
 
        sendButton.addEventListener("click",function(){
 
          $("#div_load_image").show();
            var formData = new FormData();
            // form Data 객체 생성
            formData.append("file", fileInput.files[0]);
            // 파일 인풋에 들어간 파일들은 files 라는 리스트로 저장된다.
            // input에 multiple을 선언해 여러개의 파일을 선택한 경우가 아니라면 files[0] 으로 input에 추가한 파일 객체를 찾을 수 있다.
            
            fetch('/single/upload', {
                method: 'POST',
                cache: 'no-cache',
                body: formData // body 부분에 폼데이터 변수를 할당
            })
            .then((response) => response.json())
            .then((data) => {
                console.log(data);
                $("#div_load_image").hide();
                alert("업로드를 완료했습니다");
            });
        });
 
    </script>
  </body>
</html>
